<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BIRRA AI - QUANTUM PRO</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --gold: #ffcc00; --bg: #000; --card: #0a0a0a; --green: #00ff41; --red: #ff3131; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; margin: 0; overflow: hidden; height: 100vh; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        /* Ticker News Fluido */
        .ticker-wrap { height: 35px; background: #111; border-bottom: 1px solid var(--gold); overflow: hidden; display: flex; align-items: center; }
        .ticker-move { white-space: nowrap; will-change: transform; animation: scroll 50s linear infinite; color: var(--gold); font-size: 0.7rem; font-weight: bold; transform: translate3d(0,0,0); }
        @keyframes scroll { from { transform: translate3d(0,0,0); } to { transform: translate3d(-100%,0,0); } }

        /* Header Compatto */
        .header { padding: 20px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 15px; }
        .logo-box { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--gold); overflow: hidden; box-shadow: 0 0 15px rgba(255,204,0,0.2); }
        .logo-img { width: 100%; height: 100%; object-fit: cover; }
        .app-title { font-size: 0.9rem; font-weight: 900; letter-spacing: 2px; color: var(--gold); }

        /* Sezione Prezzo e Grafico */
        .main-section { padding: 0 20px; text-align: center; }
        #btc-price { font-size: 3rem; font-weight: 900; font-variant-numeric: tabular-nums; margin: 0; letter-spacing: -1px; line-height: 1; }
        .chart-container { height: 80px; margin: 15px 0; position: relative; }

        /* ROI Calculator (Nuova Funzione!) */
        .roi-box { background: var(--card); margin: 10px 20px; padding: 15px; border-radius: 15px; border: 1px solid #222; }
        .roi-input { background: #111; border: 1px solid var(--gold); color: var(--gold); padding: 10px; width: 100%; border-radius: 10px; font-size: 1.2rem; font-weight: bold; text-align: center; margin-top: 5px; }
        .roi-result { text-align: center; font-size: 0.8rem; color: #888; margin-top: 10px; }
        #roi-percent { color: var(--green); font-weight: bold; font-size: 1rem; }

        /* Pulsante Azione */
        .btn-elite { position: absolute; bottom: 25px; left: 20px; right: 20px; background: linear-gradient(45deg, var(--gold), #ffaa00); color: black; border: none; padding: 20px; border-radius: 18px; font-weight: 900; font-size: 1rem; text-transform: uppercase; text-decoration: none; text-align: center; display: block; box-shadow: 0 5px 25px rgba(255, 204, 0, 0.3); }
    </style>
</head>
<body>

    <div class="ticker-wrap">
        <div class="ticker-move" id="news">CONNESSIONE AI MERCATI QUANTISTICI... +++ ANALISI AI IN CORSO +++ CARICAMENTO NEWS LIVE...</div>
    </div>

    <div class="header">
        <div class="logo-box">
            <img src="7418a0a9-2f5b-4366-8d18-20224213038d.jpg" class="logo-img" alt="Logo" onerror="this.src='https://via.placeholder.com/60/ffcc00/000000?text=AI'">
        </div>
        <div class="app-title">QUANTUM PRO v8</div>
    </div>

    <div class="main-section">
        <div id="btc-price">$ --.---</div>
        <div id="perc" style="font-weight: bold; font-size: 1rem; margin-top: 5px;">0.00% (24h)</div>
        <div class="chart-container">
            <canvas id="sparkline"></canvas>
        </div>
    </div>

    <div class="roi-box">
        <div style="font-size: 0.7rem; color: #666; text-transform: uppercase;">Proiezione Target ($)</div>
        <input type="number" id="target-input" class="roi-input" value="100000" oninput="calcROI()">
        <div class="roi-result">Potenziale guadagno: <span id="roi-percent">--%</span></div>
    </div>

    <a href="https://www.binance.com" class="btn-elite">⚡ Opera sul Mercato Reale</a>

    <script>
        let currentPrice = 0;
        let priceHistory = [];
        let myChart;

        // Inizializzazione Grafico Vuoto
        function initChart() {
            const ctx = document.getElementById('sparkline').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'line',
                data: { labels: [], datasets: [{ data: [], borderColor: '#ffcc00', borderWidth: 2, tension: 0.4, pointRadius: 0, fill: true, backgroundColor: 'rgba(255, 204, 0, 0.1)' }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: {display: false} }, scales: { x: {display: false}, y: {display: false} } }
            });
        }

        async function sync() {
            try {
                // Usiamo un'API che ci dà anche un po' di storico per il grafico
                const r = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=1&interval=hourly');
                const data = await r.json();
                const prices = data.prices;
                
                // Ultimo prezzo
                currentPrice = prices[prices.length-1][1];
                const startPrice = prices[0][1];
                const change24h = ((currentPrice - startPrice) / startPrice) * 100;

                // Update UI
                const btcEl = document.getElementById('btc-price');
                btcEl.innerText = "$" + currentPrice.toLocaleString(undefined, {maximumFractionDigits: 0});
                btcEl.style.color = currentPrice >= startPrice ? '#fff' : '#ff3131';
                
                const pEl = document.getElementById('perc');
                pEl.innerText = (change24h >= 0 ? '+' : '') + change24h.toFixed(2) + "% (24h)";
                pEl.style.color = change24h >= 0 ? '#00ff41' : '#ff3131';

                // Update Grafico (Prendiamo gli ultimi 20 punti per la sparkline)
                const recentPrices = prices.slice(-20).map(p => p[1]);
                myChart.data.labels = new Array(recentPrices.length).fill("");
                myChart.data.datasets[0].data = recentPrices;
                myChart.data.datasets[0].borderColor = change24h >= 0 ? '#ffcc00' : '#ff3131';
                myChart.data.datasets[0].backgroundColor = change24h >= 0 ? 'rgba(255, 204, 0, 0.1)' : 'rgba(255, 49, 49, 0.1)';
                myChart.update('none'); // Aggiornamento silenzioso senza animazione pesante

                calcROI(); // Ricalcola ROI con il nuovo prezzo

            } catch(e) { console.log("Sync error"); }
        }

        function calcROI() {
            if(currentPrice === 0) return;
            const target = document.getElementById('target-input').value;
            const gain = ((target - currentPrice) / currentPrice) * 100;
            const roiEl = document.getElementById('roi-percent');
            roiEl.innerText = (gain > 0 ? '+' : '') + gain.toFixed(2) + "%";
            roiEl.style.color = gain > 0 ? '#00ff41' : '#ff3131';
        }

        async function getNews() {
            try {
                const res = await fetch('https://min-api.cryptocompare.com/data/v2/news/?lang=IT');
                const data = await res.json();
                document.getElementById('news').innerText = data.Data.slice(0, 5).map(n => n.title.toUpperCase()).join(' +++ ') + " +++ ";
            } catch(e) {}
        }

        initChart();
        sync();
        getNews();
        setInterval(sync, 30000); // Aggiorna ogni 30s per non stressare il grafico
        setInterval(getNews, 300000);
    </script>
</body>
</html>
