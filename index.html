<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BIRRA AI - ARBITRAGE SCANNER</title>
    <style>
        :root { --gold: #ffcc00; --bg: #0a0a0a; --green: #00ff41; --red: #ff3131; }
        body { background: var(--bg); color: white; font-family: 'Courier New', monospace; margin: 0; padding: 20px; text-align: center; }
        
        .header { border-bottom: 2px solid var(--gold); padding-bottom: 15px; margin-bottom: 20px; }
        .logo { width: 80px; border-radius: 50%; border: 2px solid var(--gold); }
        
        .scanner-grid { display: grid; gap: 15px; margin-bottom: 20px; }
        .exchange-card { background: #111; border: 1px solid #333; padding: 15px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
        .ex-name { color: var(--gold); font-weight: bold; }
        .ex-price { font-size: 1.2rem; }

        .opportunity-box { background: rgba(0, 255, 65, 0.1); border: 2px dashed var(--green); padding: 20px; border-radius: 15px; margin-top: 20px; display: none; }
        .alert-active { display: block; animation: flash 1s infinite; }
        @keyframes flash { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .btn-update { background: var(--gold); color: black; border: none; padding: 15px; width: 100%; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        #log { font-size: 0.7rem; color: #666; margin-top: 20px; text-align: left; height: 80px; overflow-y: auto; }
    </style>
</head>
<body>

    <div class="header">
        <img src="https://raw.githubusercontent.com/Tommy9832610/Birra-Gatto/main/7418a0a9-2f5b-4366-8d18-20224213038d.jpg" class="logo">
        <h2>SCANNER REALE 2026</h2>
    </div>

    <div class="scanner-grid">
        <div class="exchange-card">
            <span class="ex-name">BINANCE</span>
            <span id="price-binance" class="ex-price">---</span>
        </div>
        <div class="exchange-card">
            <span class="ex-name">KRAKEN</span>
            <span id="price-kraken" class="ex-price">---</span>
        </div>
        <div class="exchange-card">
            <span class="ex-name">COINBASE</span>
            <span id="price-coinbase" class="ex-price">---</span>
        </div>
    </div>

    <div id="alert-box" class="opportunity-box">
        <h3 style="color: var(--green); margin: 0;">âš¡ OCCASIONE RILEVATA!</h3>
        <p id="alert-text" style="font-size: 0.9rem;">Differenza di prezzo rilevata tra gli exchange.</p>
    </div>

    <button class="btn-update" onclick="checkArbitrage()">SCANSIONA MERCATI</button>

    <div id="log">> Inizializzazione sensori...</div>

    <script>
        function addLog(msg) {
            const logBox = document.getElementById('log');
            logBox.innerHTML += `<br>> ${msg}`;
            logBox.scrollTop = logBox.scrollHeight;
        }

        async function getPrices() {
            try {
                // Binance (API Diretta)
                const resB = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');
                const dataB = await resB.json();
                const pB = parseFloat(dataB.price);

                // Kraken (API Diretta)
                const resK = await fetch('https://api.kraken.com/0/public/Ticker?pair=XBTUSD');
                const dataK = await resK.json();
                const pK = parseFloat(dataK.result.XXBTZUSD.c[0]);

                // Coinbase (API Diretta)
                const resC = await fetch('https://api.coinbase.com/v2/prices/BTC-USD/spot');
                const dataC = await resC.json();
                const pC = parseFloat(dataC.data.amount);

                return { binance: pB, kraken: pK, coinbase: pC };
            } catch (e) {
                addLog("Errore connessione API...");
                return null;
            }
        }

        async function checkArbitrage() {
            addLog("Scansione in corso...");
            const prices = await getPrices();
            if (!prices) return;

            document.getElementById('price-binance').innerText = "$" + prices.binance.toLocaleString();
            document.getElementById('price-kraken').innerText = "$" + prices.kraken.toLocaleString();
            document.getElementById('price-coinbase').innerText = "$" + prices.coinbase.toLocaleString();

            const pArray = [
                { name: 'Binance', val: prices.binance },
                { name: 'Kraken', val: prices.kraken },
                { name: 'Coinbase', val: prices.coinbase }
            ];

            pArray.sort((a, b) => a.val - b.val);
            const min = pArray[0];
            const max = pArray[2];
            const diff = max.val - min.val;
            const perc = (diff / min.val) * 100;

            if (perc > 0.4) {
                document.getElementById('alert-box').classList.add('alert-active');
                document.getElementById('alert-text').innerHTML = 
                    `Compra su <b>${min.name}</b> e vendi su <b>${max.name}</b>.<br>Guadagno stimato: <b>${perc.toFixed(2)}%</b> ($${diff.toFixed(2)})`;
                addLog(`!!! SPREAD RILEVATO: ${perc.toFixed(2)}%`, 'green');
            } else {
                document.getElementById('alert-box').classList.remove('alert-active');
                addLog(`Mercato stabile (Spread: ${perc.toFixed(2)}%)`);
            }
        }

        setInterval(checkArbitrage, 30000); // Controlla ogni 30 secondi
        checkArbitrage();
    </script>
</body>
</html>
