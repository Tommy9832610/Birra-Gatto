<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Birra AI - Terminal</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root { --gold: #ffcc00; --bg: #000; --text: #0f0; }
        body { background: var(--bg); color: white; font-family: 'Courier New', monospace; margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh; }
        
        .header { text-align: center; padding: 10px; flex-shrink: 0; }
        .logo-container { position: relative; display: inline-block; }
        .logo { width: 60px; height: 60px; border-radius: 50%; border: 2px solid var(--gold); transition: transform 0.3s; }
        .eyes { position: absolute; top: 28px; left: 0; width: 100%; display: flex; justify-content: space-around; opacity: 0; transition: 0.5s; }
        .eye { width: 5px; height: 5px; background: var(--gold); border-radius: 50%; box-shadow: 0 0 10px var(--gold); }
        .bullish .eyes { opacity: 1; }

        .price-box { text-align: center; font-size: 2rem; font-weight: bold; margin: 2px 0; color: white; }
        .change { font-size: 0.9rem; color: #00ff00; margin-bottom: 5px; }

        /* Contenitore Grafico - Ora funzionante */
        #chart-container { flex-grow: 1; width: 100%; background: #000; position: relative; }

        .terminal { background: rgba(0, 0, 0, 0.9); padding: 8px; height: 80px; overflow-y: auto; font-size: 0.8rem; border-top: 1px solid #222; color: #aaa; }
        .input-line { display: flex; background: #050505; padding: 10px; border-top: 1px solid #333; align-items: center; }
        .input-line span { color: var(--gold); margin-right: 10px; }
        input { background: none; border: none; color: var(--text); outline: none; width: 100%; font-family: inherit; font-size: 0.9rem; }

        .btn-trade { background: var(--gold); color: #000; width: 94%; margin: 8px 3%; padding: 14px; border: none; border-radius: 8px; font-weight: 900; font-size: 1rem; text-transform: uppercase; cursor: pointer; flex-shrink: 0; }
    </style>
</head>
<body>

    <div class="header">
        <div class="logo-container" id="cat-logo">
            <img src="logo.png" class="logo" alt="Birra AI">
            <div class="eyes"><div class="eye"></div><div class="eye"></div></div>
        </div>
        <div class="price-box" id="btc-price">$ --.---,--</div>
        <div class="change" id="btc-change">+0.00%</div>
    </div>

    <div id="chart-container">
        <div class="tradingview-widget-container" style="height:100%;width:100%">
            <div id="tradingview_charts" style="height:100%;width:100%"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
            <script type="text/javascript">
            new TradingView.widget({
              "autosize": true,
              "symbol": "BINANCE:BTCUSDT",
              "interval": "60",
              "timezone": "Etc/UTC",
              "theme": "dark",
              "style": "1",
              "locale": "it",
              "toolbar_bg": "#f1f3f6",
              "enable_publishing": false,
              "hide_top_toolbar": true,
              "save_image": false,
              "container_id": "tradingview_charts"
            });
            </script>
        </div>
    </div>

    <div class="terminal" id="output">
        <div>> Birra AI Terminal v1.1 caricato...</div>
        <div>> Grafico ripristinato. Sistema pronto.</div>
    </div>

    <div class="input-line">
        <span>$</span><input type="text" id="commandInput" placeholder="Inserisci comando...">
    </div>

    <button class="btn-trade" onclick="execTrade()">‚ö° OPERA ORA</button>

    <audio id="beer-sound" src="https://www.myinstants.com/media/sounds/beer-opening.mp3"></audio>

    <script>
        // Gestione Prezzo e Mood del Gatto
        async function fetchMarketData() {
            try {
                const res = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT');
                const data = await res.json();
                const price = parseFloat(data.lastPrice).toLocaleString('it-IT', { minimumFractionDigits: 2 });
                const change = parseFloat(data.priceChangePercent).toFixed(2);
                document.getElementById('btc-price').innerText = `$ ${price}`;
                document.getElementById('btc-change').innerText = `${change > 0 ? '+' : ''}${change}%`;
                if (change > 0) document.getElementById('cat-logo').classList.add('bullish');
                else document.getElementById('cat-logo').classList.remove('bullish');
            } catch (e) { console.error("Errore API"); }
        }
        setInterval(fetchMarketData, 5000);
        fetchMarketData();

        // Terminale CLI
        const input = document.getElementById('commandInput');
        const output = document.getElementById('output');
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const cmd = input.value.toLowerCase().trim();
                const newLine = document.createElement('div');
                if (cmd === '/info') newLine.innerText = "> Birra AI: Terminale Quantistico v1.1.";
                else if (cmd === '/clear') { output.innerHTML = ''; input.value = ''; return; }
                else newLine.innerText = `> Comando '${cmd}' ricevuto.`;
                output.appendChild(newLine);
                input.value = '';
                output.scrollTop = output.scrollHeight;
            }
        });

        function execTrade() {
            document.getElementById('beer-sound').play();
            const log = document.createElement('div');
            log.style.color = '#ffcc00';
            log.innerText = "> [ORDINE]: Operazione avviata. Cheers! üçª";
            output.appendChild(log);
            output.scrollTop = output.scrollHeight;
        }
    </script>
</body>
</html>
